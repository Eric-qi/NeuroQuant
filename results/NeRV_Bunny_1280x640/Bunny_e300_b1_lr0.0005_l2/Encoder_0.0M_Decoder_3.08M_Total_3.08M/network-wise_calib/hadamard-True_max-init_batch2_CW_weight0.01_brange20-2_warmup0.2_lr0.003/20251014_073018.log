2025-10-14 07:30:18,674 [INFO ]  Logging file is results/NeRV_Bunny_1280x640/Bunny_e300_b1_lr0.0005_l2/Encoder_0.0M_Decoder_3.08M_Total_3.08M/network-wise_calib/hadamard-True_max-init_batch2_CW_weight0.01_brange20-2_warmup0.2_lr0.003/20251014_073018.log
2025-10-14 07:30:18,674 [INFO ]  [PID] 1373676
2025-10-14 07:30:18,674 [INFO ]  ================== Model Architecture=================
2025-10-14 07:30:18,675 [INFO ]  NeRV(
  (encoder): PositionEncoding()
  (decoder): ModuleList(
    (0): Conv2d(160, 1160, kernel_size=(1, 1), stride=(1, 1))
    (1): NeRVBlock(
      (conv): Sequential(
        (0): Conv2d(145, 1800, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): PixelShuffle(upscale_factor=5)
      )
      (norm): Identity()
      (act): GELU(approximate='none')
    )
    (2): NeRVBlock(
      (conv): Sequential(
        (0): Conv2d(72, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): PixelShuffle(upscale_factor=4)
      )
      (norm): Identity()
      (act): GELU(approximate='none')
    )
    (3): NeRVBlock(
      (conv): Sequential(
        (0): Conv2d(36, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): PixelShuffle(upscale_factor=4)
      )
      (norm): Identity()
      (act): GELU(approximate='none')
    )
    (4-5): 2 x NeRVBlock(
      (conv): Sequential(
        (0): Conv2d(24, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): PixelShuffle(upscale_factor=2)
      )
      (norm): Identity()
      (act): GELU(approximate='none')
    )
  )
  (head_layer): Conv2d(24, 3, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
)
2025-10-14 07:30:18,675 [INFO ]  Encoder_0.0M_Decoder_3.08M_Total_3.08M
2025-10-14 07:30:18,675 [INFO ]  => loading checkpoint 'results/NeRV_Bunny_1280x640/Bunny_e300_b1_lr0.0005_l2/Encoder_0.0M_Decoder_3.08M_Total_3.08M/epoch300.pth'
2025-10-14 07:30:19,409 [INFO ]  =======================Full-precision model========================
2025-10-14 07:30:20,445 [INFO ]  [2025/10/14 07:30:20], Eval at Step [1/132], FPS 2.0, PSNR 32.02, MS-SSIM 0.9513
2025-10-14 07:30:21,560 [INFO ]  [2025/10/14 07:30:21], Eval at Step [51/132], FPS 78.2, PSNR 31.46, MS-SSIM 0.9437
2025-10-14 07:30:22,750 [INFO ]  [2025/10/14 07:30:22], Eval at Step [101/132], FPS 122.6, PSNR 32.7, MS-SSIM 0.9556
2025-10-14 07:30:23,372 [INFO ]  [2025/10/14 07:30:23], Eval at Step [132/132], FPS 141.8, PSNR 33.25, MS-SSIM 0.9604
2025-10-14 07:30:23,529 [INFO ]  Evaluation ... 
 2025_10_14_07_30_19 Results for checkpoint: results/NeRV_Bunny_1280x640/Bunny_e300_b1_lr0.0005_l2/Encoder_0.0M_Decoder_3.08M_Total_3.08M/epoch300.pth
best_pred_seen_psnr: 33.25 | best_pred_seen_ssim: 0.9604 | best_pred_unseen_psnr: 0.0 | best_pred_unseen_ssim: 0.0 | 
2025-10-14 07:30:23,542 [INFO ]  quantized model architecture: QuantModel(
  (model): NeRV(
    (encoder): PositionEncoding()
    (decoder): ModuleList(
      (0): QuantModule(
        160, 1160, kernel_size=(1, 1), stride=(1, 1)
        (weight_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
        (bias_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
      )
      (1): QuantNeRVBlock(
        (conv): QuantModule(
          145, 1800, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
          (weight_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
          (bias_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
        )
        (pixelshuffle): PixelShuffle(upscale_factor=5)
        (act): GELU(approximate='none')
      )
      (2): QuantNeRVBlock(
        (conv): QuantModule(
          72, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
          (weight_quantizer): UniformAffineQuantizer(bit=4, scale_method=max, symmetric=False, channel_wise=True,)
          (bias_quantizer): UniformAffineQuantizer(bit=4, scale_method=max, symmetric=False, channel_wise=True,)
        )
        (pixelshuffle): PixelShuffle(upscale_factor=4)
        (act): GELU(approximate='none')
      )
      (3): QuantNeRVBlock(
        (conv): QuantModule(
          36, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
          (weight_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
          (bias_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
        )
        (pixelshuffle): PixelShuffle(upscale_factor=4)
        (act): GELU(approximate='none')
      )
      (4): QuantNeRVBlock(
        (conv): QuantModule(
          24, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
          (weight_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
          (bias_quantizer): UniformAffineQuantizer(bit=5, scale_method=max, symmetric=False, channel_wise=True,)
        )
        (pixelshuffle): PixelShuffle(upscale_factor=2)
        (act): GELU(approximate='none')
      )
      (5): QuantNeRVBlock(
        (conv): QuantModule(
          24, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
          (weight_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
          (bias_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
        )
        (pixelshuffle): PixelShuffle(upscale_factor=2)
        (act): GELU(approximate='none')
      )
    )
    (head_layer): QuantModule(
      24, 3, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
      (weight_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
      (bias_quantizer): UniformAffineQuantizer(bit=6, scale_method=max, symmetric=False, channel_wise=True,)
    )
  )
)
2025-10-14 07:30:23,542 [INFO ]  input embedding shape: torch.Size([132, 160, 1, 1])
2025-10-14 07:30:23,542 [INFO ]  torch.Size([2, 160, 1, 1])
2025-10-14 07:30:25,586 [INFO ]  Init time: 2.043362855911255
2025-10-14 07:30:25,586 [INFO ]  =======================Close quantization model========================
2025-10-14 07:30:25,847 [INFO ]  [2025/10/14 07:30:25], Eval at Step [1/132], FPS 176.6, PSNR 32.02, MS-SSIM 0.9513
2025-10-14 07:30:26,852 [INFO ]  [2025/10/14 07:30:26], Eval at Step [51/132], FPS 286.9, PSNR 31.46, MS-SSIM 0.9437
2025-10-14 07:30:27,872 [INFO ]  [2025/10/14 07:30:27], Eval at Step [101/132], FPS 304.3, PSNR 32.7, MS-SSIM 0.9556
2025-10-14 07:30:28,597 [INFO ]  [2025/10/14 07:30:28], Eval at Step [132/132], FPS 304.4, PSNR 33.25, MS-SSIM 0.9604
2025-10-14 07:30:28,776 [INFO ]  Evaluation ... 
 2025_10_14_07_30_28 
best_pred_seen_psnr: 33.25 | best_pred_seen_ssim: 0.9604 | best_pred_unseen_psnr: 0.0 | best_pred_unseen_ssim: 0.0 | 
2025-10-14 07:30:28,776 [INFO ]  =======================Weight quantization model w/o opt========================
2025-10-14 07:30:29,032 [INFO ]  [2025/10/14 07:30:29], Eval at Step [1/132], FPS 73.3, PSNR 30.15, MS-SSIM 0.9306
2025-10-14 07:30:30,434 [INFO ]  [2025/10/14 07:30:30], Eval at Step [51/132], FPS 83.4, PSNR 30.04, MS-SSIM 0.9276
2025-10-14 07:30:32,084 [INFO ]  [2025/10/14 07:30:32], Eval at Step [101/132], FPS 82.9, PSNR 30.76, MS-SSIM 0.9389
2025-10-14 07:30:33,011 [INFO ]  [2025/10/14 07:30:33], Eval at Step [132/132], FPS 86.6, PSNR 31.0, MS-SSIM 0.9428
2025-10-14 07:30:33,173 [INFO ]  Evaluation ... 
 2025_10_14_07_30_33 
best_pred_seen_psnr: 31.0 | best_pred_seen_ssim: 0.9428 | best_pred_unseen_psnr: 0.0 | best_pred_unseen_ssim: 0.0 | 
2025-10-14 07:30:33,174 [INFO ]  [PID] 1373676
2025-10-14 07:30:33,174 [INFO ]  ======================= Hyper Parameters =======================
2025-10-14 07:30:33,174 [INFO ]  param init: max
2025-10-14 07:30:33,174 [INFO ]  channel wise: True
2025-10-14 07:30:33,174 [INFO ]  seed: 903
2025-10-14 07:30:33,174 [INFO ]  iterations: 21000
2025-10-14 07:30:33,174 [INFO ]  batch_size: 2
2025-10-14 07:30:33,174 [INFO ]  loss weight: 0.01
2025-10-14 07:30:33,174 [INFO ]  input drop rate: 1.0
2025-10-14 07:30:33,174 [INFO ]  average bit-width: 4.946213722986429
2025-10-14 07:30:33,174 [INFO ]  ========================== nerv ==========================
2025-10-14 07:30:33,174 [INFO ]  begin training in cuda:0
2025-10-14 07:30:57,622 [INFO ]  Total loss:	0.0025 (rec:0.0025, round:0.0000)	b=0.00	count=500
2025-10-14 07:31:20,516 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,517 [INFO ]  init time: 0.0005731582641601562
2025-10-14 07:31:20,518 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,518 [INFO ]  init time: 0.00029087066650390625
2025-10-14 07:31:20,519 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,520 [INFO ]  init time: 0.0010576248168945312
2025-10-14 07:31:20,520 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,520 [INFO ]  init time: 0.00019407272338867188
2025-10-14 07:31:20,521 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,521 [INFO ]  init time: 0.0001857280731201172
2025-10-14 07:31:20,521 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,522 [INFO ]  init time: 0.0001735687255859375
2025-10-14 07:31:20,522 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,523 [INFO ]  init time: 0.000591278076171875
2025-10-14 07:31:20,523 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,523 [INFO ]  init time: 0.00018143653869628906
2025-10-14 07:31:20,523 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,524 [INFO ]  init time: 0.00018715858459472656
2025-10-14 07:31:20,524 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,524 [INFO ]  init time: 0.0001728534698486328
2025-10-14 07:31:20,525 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,525 [INFO ]  init time: 0.00018453598022460938
2025-10-14 07:31:20,525 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,525 [INFO ]  init time: 0.00017499923706054688
2025-10-14 07:31:20,526 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,526 [INFO ]  init time: 0.00018358230590820312
2025-10-14 07:31:20,526 [INFO ]  Init alpha to be FP32
2025-10-14 07:31:20,526 [INFO ]  init time: 0.00016736984252929688
2025-10-14 07:31:47,098 [INFO ]  Total loss:	0.0021 (rec:0.0021, round:0.0000)	b=0.00	count=500
2025-10-14 07:32:13,342 [INFO ]  Total loss:	0.0014 (rec:0.0014, round:0.0000)	b=0.00	count=1000
2025-10-14 07:32:40,284 [INFO ]  Total loss:	0.0014 (rec:0.0014, round:0.0000)	b=0.00	count=1500
2025-10-14 07:33:06,603 [INFO ]  Total loss:	0.0024 (rec:0.0024, round:0.0000)	b=0.00	count=2000
2025-10-14 07:33:31,683 [INFO ]  Total loss:	0.0009 (rec:0.0009, round:0.0000)	b=0.00	count=2500
2025-10-14 07:33:57,644 [INFO ]  Total loss:	0.0010 (rec:0.0010, round:0.0000)	b=0.00	count=3000
2025-10-14 07:34:23,657 [INFO ]  Total loss:	0.0009 (rec:0.0009, round:0.0000)	b=0.00	count=3500
2025-10-14 07:34:50,309 [INFO ]  Total loss:	0.0022 (rec:0.0022, round:0.0000)	b=0.00	count=4000
2025-10-14 07:35:17,794 [INFO ]  Total loss:	19796.6543 (rec:0.0018, round:19796.6523)	b=19.68	count=4500
2025-10-14 07:35:46,690 [INFO ]  Total loss:	18060.0586 (rec:0.0014, round:18060.0566)	b=19.14	count=5000
2025-10-14 07:36:16,393 [INFO ]  Total loss:	17130.0156 (rec:0.0009, round:17130.0156)	b=18.61	count=5500
2025-10-14 07:36:43,844 [INFO ]  Total loss:	16384.7617 (rec:0.0017, round:16384.7598)	b=18.07	count=6000
2025-10-14 07:37:12,283 [INFO ]  Total loss:	15711.9629 (rec:0.0012, round:15711.9619)	b=17.54	count=6500
2025-10-14 07:37:39,991 [INFO ]  Total loss:	15062.4404 (rec:0.0023, round:15062.4385)	b=17.00	count=7000
2025-10-14 07:38:06,449 [INFO ]  Total loss:	14419.7744 (rec:0.0019, round:14419.7725)	b=16.46	count=7500
2025-10-14 07:38:32,944 [INFO ]  Total loss:	13776.8711 (rec:0.0014, round:13776.8701)	b=15.93	count=8000
2025-10-14 07:39:01,747 [INFO ]  Total loss:	13127.0176 (rec:0.0012, round:13127.0166)	b=15.39	count=8500
2025-10-14 07:39:31,413 [INFO ]  Total loss:	12464.7861 (rec:0.0010, round:12464.7852)	b=14.86	count=9000
2025-10-14 07:40:00,004 [INFO ]  Total loss:	11789.0684 (rec:0.0016, round:11789.0664)	b=14.32	count=9500
2025-10-14 07:40:29,272 [INFO ]  Total loss:	11095.2559 (rec:0.0025, round:11095.2529)	b=13.79	count=10000
2025-10-14 07:40:56,843 [INFO ]  Total loss:	10388.3789 (rec:0.0018, round:10388.3770)	b=13.25	count=10500
2025-10-14 07:41:24,643 [INFO ]  Total loss:	9668.8799 (rec:0.0021, round:9668.8779)	b=12.71	count=11000
2025-10-14 07:41:53,251 [INFO ]  Total loss:	8933.1221 (rec:0.0009, round:8933.1211)	b=12.18	count=11500
2025-10-14 07:42:21,071 [INFO ]  Total loss:	8184.8291 (rec:0.0012, round:8184.8281)	b=11.64	count=12000
2025-10-14 07:42:49,175 [INFO ]  Total loss:	7430.4570 (rec:0.0021, round:7430.4551)	b=11.11	count=12500
2025-10-14 07:43:15,777 [INFO ]  Total loss:	6666.2100 (rec:0.0017, round:6666.2085)	b=10.57	count=13000
2025-10-14 07:43:41,769 [INFO ]  Total loss:	5892.5063 (rec:0.0017, round:5892.5044)	b=10.04	count=13500
2025-10-14 07:44:09,175 [INFO ]  Total loss:	5130.3813 (rec:0.0015, round:5130.3799)	b=9.50	count=14000
2025-10-14 07:44:36,135 [INFO ]  Total loss:	4376.0508 (rec:0.0013, round:4376.0493)	b=8.96	count=14500
2025-10-14 07:45:03,030 [INFO ]  Total loss:	3643.7002 (rec:0.0016, round:3643.6987)	b=8.43	count=15000
2025-10-14 07:45:29,667 [INFO ]  Total loss:	2939.7593 (rec:0.0014, round:2939.7578)	b=7.89	count=15500
2025-10-14 07:45:56,189 [INFO ]  Total loss:	2290.0002 (rec:0.0009, round:2289.9993)	b=7.36	count=16000
2025-10-14 07:46:23,638 [INFO ]  Total loss:	1700.9449 (rec:0.0010, round:1700.9440)	b=6.82	count=16500
2025-10-14 07:46:51,082 [INFO ]  Total loss:	1186.9583 (rec:0.0011, round:1186.9572)	b=6.29	count=17000
2025-10-14 07:47:19,756 [INFO ]  Total loss:	760.8281 (rec:0.0019, round:760.8262)	b=5.75	count=17500
2025-10-14 07:47:48,068 [INFO ]  Total loss:	424.2061 (rec:0.0020, round:424.2041)	b=5.21	count=18000
2025-10-14 07:48:15,980 [INFO ]  Total loss:	185.2017 (rec:0.0024, round:185.1992)	b=4.68	count=18500
2025-10-14 07:48:42,788 [INFO ]  Total loss:	50.1036 (rec:0.0014, round:50.1022)	b=4.14	count=19000
2025-10-14 07:49:11,504 [INFO ]  Total loss:	4.2733 (rec:0.0019, round:4.2714)	b=3.61	count=19500
2025-10-14 07:49:38,779 [INFO ]  Training complete in: 0:19:05.604276
2025-10-14 07:49:38,780 [INFO ]  =======================Weight quantization model w/ opt========================
2025-10-14 07:49:39,122 [INFO ]  [2025/10/14 07:49:39], Eval at Step [1/132], FPS 48.9, PSNR 31.86, MS-SSIM 0.9493
2025-10-14 07:49:40,328 [INFO ]  [2025/10/14 07:49:40], Eval at Step [51/132], FPS 88.7, PSNR 31.3, MS-SSIM 0.9416
2025-10-14 07:49:41,295 [INFO ]  [2025/10/14 07:49:41], Eval at Step [101/132], FPS 87.8, PSNR 32.54, MS-SSIM 0.9539
2025-10-14 07:49:41,952 [INFO ]  [2025/10/14 07:49:41], Eval at Step [132/132], FPS 85.1, PSNR 33.08, MS-SSIM 0.9589
2025-10-14 07:49:42,111 [INFO ]  Evaluation ... 
 2025_10_14_07_49_38 
best_pred_seen_psnr: 33.08 | best_pred_seen_ssim: 0.9589 | best_pred_unseen_psnr: 0.0 | best_pred_unseen_ssim: 0.0 | 
2025-10-14 07:49:42,112 [INFO ]  save quantized model in results/NeRV_Bunny_1280x640/Bunny_e300_b1_lr0.0005_l2/Encoder_0.0M_Decoder_3.08M_Total_3.08M/network-wise_calib/hadamard-True_max-init_batch2_CW_weight0.01_brange20-2_warmup0.2_lr0.003
